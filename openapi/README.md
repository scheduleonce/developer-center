# OpenAPI File Organization

This directory contains the OnceHub API specification split into multiple smaller files for better maintainability and organization.

## Structure

```
openapi/
├── main.yaml                     # Main OpenAPI file with $ref imports
├── oncehub.yaml                 # Original monolithic file (backup)
├── info/
│   └── info.yaml                # API info, title, version, description
├── paths/                       # API endpoints organized by resource
│   ├── bookings.yaml           # Booking-related endpoints
│   ├── booking-calendars.yaml  # Booking calendar endpoints
│   ├── booking-pages.yaml      # Booking page endpoints
│   ├── contacts.yaml           # Contact endpoints
│   ├── event-types.yaml        # Event type endpoints
│   ├── master-pages.yaml       # Master page endpoints
│   ├── teams.yaml              # Team endpoints
│   ├── test.yaml               # Authentication/test endpoints
│   ├── users.yaml              # User endpoints
│   └── webhooks.yaml           # Webhook endpoints
└── components/                  # Reusable OpenAPI components
    ├── parameters/
    │   └── common.yaml         # Common parameters (id, pagination, etc.)
    ├── responses/
    │   └── errors.yaml         # Common error responses
    └── schemas/
        └── (future schemas)    # Data models/schemas
```

## Benefits of This Structure

1. **Maintainability**: Easier to find and edit specific endpoints
2. **Collaboration**: Multiple developers can work on different resources simultaneously
3. **Reusability**: Common components can be shared across endpoints
4. **Readability**: Smaller files are easier to understand and review
5. **Modularity**: Resources can be developed and tested independently

## Working with Split Files

### Main Entry Point

Use `main.yaml` as your primary OpenAPI specification file. It references all other files using `$ref`.

### Adding New Endpoints

1. Add the endpoint to the appropriate resource file in `paths/`
2. Update `main.yaml` to reference the new endpoint
3. Add any new reusable components to the `components/` directory

### Common Patterns

- **Parameters**: Use `$ref: '../components/parameters/common.yaml#/ParameterName'`
- **Responses**: Use `$ref: '../components/responses/errors.yaml#/ErrorType'`
- **Schemas**: Use `$ref: '../components/schemas/resource.yaml#/SchemaName'`

## Example Usage

To validate the split specification:

```bash
npx rdme openapi validate openapi/main.yaml
```

To convert back to a single file:

```bash
npx rdme openapi resolve openapi/main.yaml --out oncehub-bundled.yaml
```

## Next Steps

1. **Extract Schemas**: Move response/request schemas to `components/schemas/`
2. **Standardize Responses**: Use consistent error response references
3. **Add Examples**: Include request/response examples in schema files
4. **Documentation**: Add descriptions and examples to improve API docs

## File References

Each path file contains endpoints with keys that match the reference pattern:

- `/bookings` → `bookings.yaml#/bookings`
- `/bookings/{id}` → `bookings.yaml#/bookings-id-`
- `/bookings/{id}/cancel` → `bookings.yaml#/bookings-id-cancel`

The keys are generated by removing special characters from path names for valid YAML references.

// TODO

- [] Make sure all expansions are mentioned
- Version switcher
- remove x-readme tags
